### ğŸ” Harminv å¦‚ä½•å¾æ™‚åŸŸæå– Q å€¼ï¼Ÿ

`harminv` æ˜¯ Meep ä¸­çš„è«§æ³¢åˆ†æå·¥å…·ï¼Œå¯å¾æ™‚åŸŸå ´é‡è³‡æ–™ä¸­æ“·å–æ¨¡æ…‹çš„é »ç‡èˆ‡ Q å€¼ï¼Œé©ç”¨æ–¼å…±æŒ¯è…”ã€SPPã€å…‰å­æ™¶é«”ç­‰çµæ§‹ã€‚

### ğŸ“ æ•¸å­¸åŸç†

å‡è¨­å ´ç‚ºä¸‹åˆ—å½¢å¼çš„ç–ŠåŠ ï¼š

$$
E(t) = \sum_n A_n e^{i\omega_n t} e^{-\gamma_n t}
$$

- $\omega_n$ï¼šæ¨¡æ…‹é »ç‡ï¼ˆå¼§åº¦/ç§’ï¼‰
- $\gamma_n$ï¼šè¡°æ¸›ç‡
- **Q å€¼å…¬å¼**ï¼š

$$
Q_n = \frac{\omega_n}{2\gamma_n}
$$

---

### âš™ï¸ Meep ä½¿ç”¨ç¯„ä¾‹

```python
sim.run(mp.after_sources(
            mp.Harminv(mp.Ez, mp.Vector3(x), fcen, df)),
        until_after_sources=mp.stop_when_fields_decayed(50, mp.Ez, mp.Vector3(x), 1e-3))
````

^aedd99

- `mp.Ez`ï¼šç›£æ¸¬çš„å ´åˆ†é‡
- `mp.Vector3(x)`ï¼šè§€æ¸¬é»ä½ç½®
- `fcen`ï¼šä¸­å¿ƒé »ç‡ï¼ˆè¦åˆ†æçš„é »ç‡é™„è¿‘ï¼‰
- `df`ï¼šé »ç‡ç¯„åœï¼ˆä¾‹å¦‚ 0.2ï¼‰
- [[meep_spp_harminv_notes]]


---

### ğŸ“Š è¼¸å‡ºç¯„ä¾‹è§£æ

```
freq: 0.1552  Q: 1200  decay time: 197  |A|: 0.37
freq: 0.1618  Q: 80    decay time: 10   |A|: 0.05
```

| æ¬„ä½           | èªªæ˜                  |
| ------------ | ------------------- |
| `freq`       | æ¨¡æ…‹é »ç‡ï¼ˆHzï¼Œæˆ– Meep å–®ä½ï¼‰  |
| `Q`          | å“è³ªå› å­ï¼ˆè¶Šé«˜è¶Šç©©å®šï¼Œå…±æŒ¯è¶Šå°–éŠ³ï¼‰   |
| `decay time` | å ´é‡è¡°æ¸›æ™‚é–“/ æ¨¡æ…‹çš„å£½å‘½ï¼ˆå–®ä½æ™‚é–“ï¼‰ |
| \|`A`\|      | å°æ‡‰æ¨¡æ…‹çš„æŒ¯å¹…ï¼ˆé‡è¦æ€§/å¼·åº¦ï¼‰     |

---

### ğŸ” å¸¸è¦‹æ‡‰ç”¨èˆ‡ Q å€¼æ„ç¾©

| çµæ§‹é¡å‹       | Q å€¼ä»£è¡¨æ„ç¾©                     |
| ---------- | --------------------------- |
| å¾®ç’°å…±æŒ¯è…”      | è©•ä¼°å…±æŒ¯å°–éŠ³ç¨‹åº¦ã€èƒ½é‡å„²å­˜æ•ˆç‡             |
| è¡¨é¢é›»æ¼¿å­ï¼ˆSPPï¼‰ | åˆ†ææ¨¡æ…‹åœ¨é‡‘å±¬ä¸­çš„è¡°æ¸›èˆ‡å‚³æ’­è·é›¢            |
| å…‰å­æ™¶é«”è…”      | æ‰¾å‡ºå±€åŸŸæ¨¡æ…‹çš„é »ç‡èˆ‡å£½å‘½ï¼ˆQï¼‰             |
| ç™¼å…‰å¢å¼·çµæ§‹     | ç”¨æ–¼ä¼°ç®— [[Purcell factor]]å¢å¼·å› å­ |

---

### âš ï¸ ä½¿ç”¨æ³¨æ„

- æ¨¡æ“¬æ™‚é–“éœ€è¶³å¤ é•·ï¼Œå ´éœ€æ˜é¡¯è¡°æ¸›
  >å¦‚æœæ™‚é–“åºåˆ—ä¸å¤ é•·ã€æˆ–è¨Šè™Ÿå¤ªå¼±ï¼Œ`harminv` å¯èƒ½æœƒå¤±æ•—æˆ–è¼¸å‡ºä¸ç©©å®š
- é ˆé¿å…æ¿€ç™¼å¤ªå¤šæ¨¡æ…‹é€ æˆå¹²æ“¾
  >Gaussian pulse å¤ªå¯¬é »æ™‚ï¼Œå¯èƒ½æœƒåŒæ™‚æ¿€ç™¼å¤šå€‹æ¨¡æ…‹ï¼Œéœ€å°å¿ƒé »è­œåˆ†æ
- `fcen` å’Œ `df` çš„è¨­å®šè¦åŒ…å«ç›®æ¨™é »ç‡
  >é ˆè®“æ¨¡æ“¬ **æŒçºŒè¶³å¤ é•·æ™‚é–“**ï¼Œç›´åˆ°å ´é‡è¡°æ¸›ï¼Œå¦å‰‡ç„¡æ³•æº–ç¢ºæ“·å– Q å€¼

---

### âœ… å»ºè­°æ­¥é©Ÿï¼ˆä»¥ SPP ç‚ºä¾‹ï¼‰

1. ä½¿ç”¨ Gaussian source é è¿‘é‡‘å±¬ä»‹é¢æ¿€ç™¼å¯¬é »æ³¢ã€‚
2. åœ¨é‡‘å±¬æ—é‚Šè¨­ç½®ç›£æ¸¬é»ï¼Œè¨˜éŒ„ Ezã€‚
3. ä½¿ç”¨ `harminv` åˆ†æ Ez çš„æ™‚é–“åºåˆ—ï¼Œæ“·å–é »ç‡èˆ‡ Q å€¼ã€‚

---

### ğŸ“ å»¶ä¼¸é–±è®€

- [Meep official doc: harminv](https://meep.readthedocs.io/en/latest/Python_User_Interface/#harminv)
- [Harminv paper by Steven G. Johnson](https://arxiv.org/abs/physics/0211069)
